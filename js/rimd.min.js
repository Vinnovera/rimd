!function(t,e){"use strict";function n(n){function o(){for(var t,e=/\{([\s\S]+?)\}/g,n="";null!==(t=e.exec(N.path));)n+="|\\{"+t[1]+"\\}";return new RegExp(n.substr(1),"g")}function u(t){for(var e=h(t),n=t.length,r=0;n>r;r++)e[r].offsetWidth?(x.push(i(t[r],e[r],N.lazyload,N.centerImage)),H.push(t[r]),O.push(e[r])):W.push(t[r])}function l(t){var e,n,i,r=t.src.split("?");return t.path=r[0],e=d(t.path),-1!==N.blacklist.indexOf(e)?t.path:(i=N.path.replace(L,function(e,n,i){return c(t,e,n,i)}),r.length>1&&(n=r[1],i+=b?"&"+n:"?"+n),t.path=i,i)}function c(t,e){var n;switch(e){case"{width}":return n=y(N.widths,t.offsetWidth)*(N.dubbleSizeRetina&&s?2:1),t.width=n,n;case"{height}":return f(t);case"{retina}":return s?1:0;case"{quality}":return s?40:80;default:return n=e.substr(1,e.length-2),n in t?t[n]:""}}function f(t){var e;return"object"==typeof N.heights?e=y(N.heights,t.offsetHeight):"aspectratio"===N.heights&&(e=~~(t.offsetHeight/t.offsetWidth*y(N.widths,t.offsetWidth))),e*=N.dubbleSizeRetina&&s?2:1,t.height=e,e}function d(t){var e,n;return t?(e=t.split(/\?|\#/i)[0],n=e.match(/(?:\.([^.]+))?$/)[1]):!1}function h(t){for(var e,n,i=[],r=t.length,a=0,s={};r>a;a++)if(i[a]={},i[a].offsetWidth=t[a].offsetWidth,i[a].offsetHeight=t[a].offsetHeight,e=t[a].getElementsByTagName("noscript")[0],e&&(s=e.dataset?e.dataset:p(e),"src"in s)){for(n in s)i[a][n]=s[n];i[a].path=l(i[a])}return i}function p(t){var e,n,i,r={},a=0;if("undefined"==typeof t||!("attributes"in t))return r;for(e=t.attributes,n=e.length;n>a;a++)/^data-/.test(e[a].name)&&(i=e[a].name.substr(5).replace(/-(.)/g),r[i]=e[a].value);return r}function g(t){var n=[];return t=t.replace(/[.]/,""),n=e.querySelectorAll?e.querySelectorAll("."+t):v(t)}function v(t){var n,i=[],r=e.getElementsByTagName("*");for(n in r)(" "+r[n].className+" ").indexOf(" "+t+" ")>-1&&i.push(r[n]);return i}function m(){var t=W;W=[],u(t)}function y(t,e){var n,i,r,a,s=0;if(!t)return e;for(n=t.length,a=t[n-1];n>s;s++){if(r=t[s]-e,N.closestAbove){if(0>r)continue}else r=0>r?~r:r;(void 0===i||i>r)&&(i=r,a=t[s])}return a}function E(){var e=0,n=x.length;for(N.reloadOnResize&&t.removeEventListener("resize",z);n>e;e++)x[e].destruct();x=null,H=null,O=null}var b,L,w,z,R,N={},T={nodeList:[],className:"rimd",widths:["320","600","1024"],heights:["320","600","1024"],path:"resimage/?image={path}&w={width}",blacklist:[],reloadOnResize:!1,lazyload:!1,closestAbove:!1,centerImage:!1,dubbleSizeRetina:!1},x=[],H=[],O=[],W=[];return N=r(T,n),b=N.path.split("?").length>1,L=o(),w=N.nodeList.length?N.nodeList:g(N.className),u(w),w=null,N.reloadOnResize&&(z=a(function(){for(var t=h(H),e=0,n=H.length;n>e;e++)"src"in t&&O[e].path!==l(t[e])&&x[e].updateImage(t[e]);O=t}),t.addEventListener("resize",z)),R={destruct:E,options:N,update:z,addImages:u,updateQueue:m}}function i(n,i,r,s){function o(i){i.path&&(f&&f.parentNode&&f.parentNode.removeChild(f),f=e.createElement("img"),f.src=i.path,i.alt&&(f.alt=i.alt),i.title&&(f.title=i.title),i["class"]&&(f.className=i["class"]),s&&(i.width&&(f.style.left="50%",f.style.marginLeft=-i.width/2+"px"),i.height&&(f.style.top="50%",f.style.marginTop=-i.height/2+"px")),!r||u(n)?n.appendChild(f):(l(),t.addEventListener("scroll",d),t.addEventListener("resize",h)))}function u(n){var i=n.dataset&&n.dataset.top?n.dataset.top:n.getBoundingClientRect().top,r=e.documentElement,a=i<=(t.pageYOffset||r.scrollTop)-(r.clientTop||0)+(t.innerHeight||r.clientHeight);return a||!n.dataset||n.dataset.top||(n.dataset.top=i),a}function l(){t.removeEventListener("scroll",d),t.removeEventListener("resize",h)}function c(){l(),f&&f.parentNode&&f.parentNode.removeChild(f),f=null}var f,d=a(function(){u(n)&&(n.appendChild(f),l())}),h=a(function(){"undefined"!=typeof n.dataset&&(n.dataset.top=n.getBoundingClientRect().top),d()});return o(i),{removeListeners:l,updateImage:o,destruct:c}}function r(t,e){for(var n in e)e.hasOwnProperty(n)&&"undefined"!=typeof e[n]&&(t[n]=e[n]);return t}function a(t,e,n){var i,r;return e=e||17,function(){var a=new Date,s=arguments;n=n||this,i&&i+e>a?(clearTimeout(r),r=setTimeout(function(){i=a,t.apply(n,s)},e)):(i=a,t.apply(n,s))}}var s=t.devicePixelRatio>1;t.addEventListener||!function(t,e,n,i,r,a,s){t[i]=e[i]=n[i]=function(t,e){var n=this;s.unshift([n,t,e,function(t){t.currentTarget=n,t.preventDefault=function(){t.returnValue=!1},t.stopPropagation=function(){t.cancelBubble=!0},t.target=t.srcElement||n,e.call(n,t)}]),this.attachEvent("on"+t,s[0][3])},t[r]=e[r]=n[r]=function(t,e){var n,i=0;for(i;n==s[i];++i)if(n[0]==this&&n[1]==t&&n[2]==e)return this.detachEvent("on"+t,s.splice(i,1)[0][3])},t[a]=e[a]=n[a]=function(t){return this.fireEvent("on"+t.type,t)}}(Window.prototype,HTMLDocument.prototype,Element.prototype,"addEventListener","removeEventListener","dispatchEvent",[]),t.Rimd=n}(this,this.document);