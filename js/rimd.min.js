/*! Rimd - v0.0.5 - 2014-08-28 */
!function(a,b){"use strict";function c(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c]);return a}function d(a,b,c){var d,e;return b=b||17,function(){var f=Date.now(),g=arguments;c=c||this,d&&d+b>f?(clearTimeout(e),e=setTimeout(function(){d=f,a.apply(c,g)},b)):(d=f,a.apply(c,g))}}var e,f;!a.addEventListener&&function(a,b,c,d,e,f,g){a[d]=b[d]=c[d]=function(a,b){var c=this;g.unshift([c,a,b,function(a){a.currentTarget=c,a.preventDefault=function(){a.returnValue=!1},a.stopPropagation=function(){a.cancelBubble=!0},a.target=a.srcElement||c,b.call(c,a)}]),this.attachEvent("on"+a,g[0][3])},a[e]=b[e]=c[e]=function(a,b){for(var c,d=0;c=g[d];++d)if(c[0]==this&&c[1]==a&&c[2]==b)return this.detachEvent("on"+a,g.splice(d,1)[0][3])},a[f]=b[f]=c[f]=function(a){return this.fireEvent("on"+a.type,a)}}(Window.prototype,HTMLDocument.prototype,Element.prototype,"addEventListener","removeEventListener","dispatchEvent",[]),f=function(c,e,f){function g(d){d.path&&(k&&k.parentNode&&k.parentNode.removeChild(k),k=b.createElement("img"),k.src=d.path,d.alt&&(k.alt=d.alt),d.title&&(k.title=d.title),!f||h(c)?c.appendChild(k):(i(),a.addEventListener("scroll",l),a.addEventListener("resize",m)))}function h(c){var d=c.dataset&&c.dataset.top?c.dataset.top:c.getBoundingClientRect().top,e=b.documentElement,f=d<=(a.pageYOffset||e.scrollTop)-(e.clientTop||0)+(a.innerHeight||e.clientHeight);return f||!c.dataset||c.dataset.top||(c.dataset.top=d),f}function i(){a.removeEventListener("scroll",l),a.removeEventListener("resize",m)}function j(){i(),k&&k.parentNode&&k.parentNode.removeChild(k),k=null}var k,l=d(function(){h(c)&&(c.appendChild(k),i())}),m=d(function(){"undefined"!=typeof c.dataset&&(c.dataset.top=c.getBoundingClientRect().top),l()});return g(e),{removeListeners:i,updateImage:g,destruct:j}},e=function(e){function g(a){return t.path.replace(/\{([\s\S]+?)\}/g,function(b,c,d){return h(a,b,c,d)})}function h(b,c){switch(c){case"{path}":return b.src;case"{fx}":return b.fx;case"{width}":return m(t.widths,b.offsetWidth)*(a.devicePixelRatio>1?2:1);case"{height}":return m(t.heights,b.offsetHeight)*(a.devicePixelRatio>1?2:1);case"{retina}":return a.devicePixelRatio>1?1:0}}function i(a){for(var b,c={},d=a.length,e=0,f={};d>e;e++){c[e]={},c[e].offsetWidth=a[e].offsetWidth,c[e].offsetHeight=a[e].offsetHeight,f=a[e].children[0].dataset||j(a[e].children[0]);for(b in f)c[e][b]=f[b];c[e].path=g(c[e])}return c}function j(a){for(var b,c={},d=0,e=a.attributes,f=e.length;f>d;d++)/^data-/.test(e[d].name)&&(b=e[d].name.substr(5).replace(/-(.)/g),c[b]=e[d].value);return c}function k(a){var c=[];return a=a.replace(/[.]/,""),c=b.querySelectorAll?b.querySelectorAll("."+a):l(a)}function l(a){var c,d=[],e=b.getElementsByTagName("*");for(c in e)(" "+e[c].className+" ").indexOf(" "+a+" ")>-1&&d.push(e[c]);return d}function m(a,b){var c,d,e,f,g=0;if(!a)return b;for(c=a.length,f=a[c-1];c>g;g++){if(e=a[g]-b,t.closestAbove){if(0>e)continue}else e=0>e?~e:e;(void 0===d||d>e)&&(d=e,f=a[g])}return f}function n(){var b=0,c=v.length;for(t.reloadOnResize&&a.removeEventListener("resize",q);c>b;b++)v[b].destruct();v=null,o=null,p=null}var o,p,q,r,s,t={},u={className:"rimd_img",widths:["320","600","1024"],heights:["320","600","1024"],path:"resimagecrop.php?image={path}&w={width}&h={height}&r={retina}&fx={fx}",reloadOnResize:!1,lazyload:!1,closestAbove:!1},v=[],w=0;for(t=c(u,e),o=k(t.className),p=i(o),r=o.length;r>w;w++)v.push(new f(o[w],p[w],t.lazyload));return t.reloadOnResize&&(q=d(function(){for(var a=i(o),b=0;r>b;b++)p[b].path!==g(a[b])&&v[b].updateImage(a[b]);p=a}),a.addEventListener("resize",q)),s={getClosestValues:m,getImageAttributes:i,legacyGetElementByClass:l,extend:c},{destruct:n,options:t,t:s}},a.Rimd=e}(this,this.document);